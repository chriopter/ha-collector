blueprint:
  name: Hue Tap Dial - via Hue Bridge
  description: Steuere Lichter mit dem Hue Tap Dial - 4 Tasten + Dial
  domain: automation
  input:
    tap_dial_device_id:
      name: Tap Dial Device ID
      description: "Device ID des Tap Dial (aus Developer Tools â†’ Events)"
      default: "052e53f841a381493060bb878452da2e"
      selector:
        text:
    button_1_short:
      name: Taste 1 - Kurz
      default: []
      selector:
        action:
    button_1_long:
      name: Taste 1 - Lang
      default: []
      selector:
        action:
    button_2_short:
      name: Taste 2 - Kurz
      default: []
      selector:
        action:
    button_2_long:
      name: Taste 2 - Lang
      default: []
      selector:
        action:
    button_3_short:
      name: Taste 3 - Kurz
      default: []
      selector:
        action:
    button_3_long:
      name: Taste 3 - Lang
      default: []
      selector:
        action:
    button_4_short:
      name: Taste 4 - Kurz
      default: []
      selector:
        action:
    button_4_long:
      name: Taste 4 - Lang
      default: []
      selector:
        action:
    dial_right:
      name: Dial - Rechts drehen
      default: []
      selector:
        action:
    dial_left:
      name: Dial - Links drehen
      default: []
      selector:
        action:

mode: parallel
max: 10
max_exceeded: silent

trigger:
  - platform: event
    event_type: hue_event
    event_data:
      device_id: !input tap_dial_device_id

variables:
  event_type: "{{ trigger.event.data.type }}"
  event_subtype: "{{ trigger.event.data.subtype }}"

action:
  - choose:
      # Button 1
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'short_release' and event_subtype == 1 }}"
        sequence: !input button_1_short
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'long_release' and event_subtype == 1 }}"
        sequence: !input button_1_long
      # Button 2
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'short_release' and event_subtype == 2 }}"
        sequence: !input button_2_short
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'long_release' and event_subtype == 2 }}"
        sequence: !input button_2_long
      # Button 3
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'short_release' and event_subtype == 3 }}"
        sequence: !input button_3_short
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'long_release' and event_subtype == 3 }}"
        sequence: !input button_3_long
      # Button 4
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'short_release' and event_subtype == 4 }}"
        sequence: !input button_4_short
      - conditions:
          - condition: template
            value_template: "{{ event_type == 'long_release' and event_subtype == 4 }}"
        sequence: !input button_4_long
      # Dial
      - conditions:
          - condition: template
            value_template: "{{ event_subtype == 'clock_wise' }}"
        sequence: !input dial_right
      - conditions:
          - condition: template
            value_template: "{{ event_subtype == 'counter_clock_wise' }}"
        sequence: !input dial_left
